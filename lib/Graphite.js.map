{"version":3,"sources":["../src/Graphite.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;IAEqB,Q;;;;;;;;qBAEnB,O,sBAAU;AAAA;;AACR,WAAO,sBAAY,UAAC,GAAD,EAAM,GAAN,EAAc;AAC/B,gCAAM,OAAN,cAAc,iBAAS;AACrB,YAAI,KAAJ,EAAW;AACT,iBAAO,IAAI,KAAJ,CAAP;AACD;AACD,eAAO,IAAI,8BAAJ,CAAP;AACD,OALD;AAMD,KAPM,CAAP;AAQD,G;;qBAED,K,kBAAM,O,EAAS;AAAA;;AACb,WAAO,sBAAY,UAAC,GAAD,EAAM,GAAN,EAAc;AAC/B,UAAM,QAAQ,EAAd;AACA,0BAAY,OAAZ,EAAqB,OAArB,CAA6B,eAAO;AAClC,YAAM,QAAQ,QAAQ,GAAR,EAAa,KAA3B;AACA,YAAM,YAAY,KAAK,KAAL,CAAW,CAAC,QAAQ,GAAR,EAAa,SAAb,IAA0B,KAAK,GAAL,EAA3B,IAAyC,IAApD,CAAlB;AACA,cAAM,IAAN,CAAW,CAAE,GAAF,EAAO,KAAP,EAAc,SAAd,EAAyB,IAAzB,EAAgC,IAAhC,CAAqC,GAArC,CAAX;AACD,OAJD;AAKA,UAAI;AACF,YAAI,OAAK,MAAL,CAAY,KAAZ,CAAkB,MAAM,IAAN,EAAlB,CAAJ;AACD,OAFD,CAEE,OAAO,GAAP,EAAY;AACZ,YAAI,GAAJ;AACD;AACF,KAZM,CAAP;AAaD,G;;;;;kBA3BkB,Q","file":"Graphite.js","sourcesContent":["import GraphiteClient from 'graphite-client';\n\nexport default class Graphite extends GraphiteClient {\n\n  connect() {\n    return new Promise((res, rej) => {\n      super.connect(error => {\n        if (error) {\n          return rej(error);\n        }\n        return res('Connected to Graphite server');\n      });\n    });\n  }\n\n  write(metrics) {\n    return new Promise((res, rej) => {\n      const lines = [];\n      Object.keys(metrics).forEach(key => {\n        const value = metrics[key].value;\n        const timestamp = Math.floor((metrics[key].timestamp || Date.now()) / 1000);\n        lines.push([ key, value, timestamp, '\\n' ].join(' '));\n      });\n      try {\n        res(this.socket.write(lines.join()));\n      } catch (err) {\n        rej(err);\n      }\n    });\n  }\n}\n"]}