{"version":3,"sources":["../src/Graphite.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;IAEqB,Q;;;AACnB,oBAAY,IAAZ,EAAkB,IAAlB,EAAwB;AAAA;AAAA,0DACtB,yBAAM,EAAE,sBAAoB,IAApB,SAA4B,IAA5B,MAAF,EAAN,CADsB;AAEvB;;qBAED,K,kBAAM,O,EAAS;AAAA;;AACb,SAAK,YAAL;;AAEA,WAAO,sBAAY,UAAC,GAAD,EAAM,GAAN,EAAc;;AAE/B,UAAM,QAAQ,oBAAY,OAAZ,EAAqB,MAArB,CAA4B,UAAC,SAAD,EAAY,GAAZ,EAAoB;AAC5D,YAAM,QAAQ,QAAQ,GAAR,EAAa,KAA3B;AACA,YAAM,YAAY,KAAK,KAAL,CAAW,CAAC,QAAQ,GAAR,EAAa,SAAb,IAA0B,KAAK,GAAL,EAA3B,IAAyC,IAApD,CAAlB;AACA,kBAAU,IAAV,CAAkB,CAAE,GAAF,EAAO,KAAP,EAAc,SAAd,EAA0B,IAA1B,CAA+B,GAA/B,CAAlB;AACA,eAAO,SAAP;AACD,OALa,EAKX,EALW,EAKP,IALO,CAKF,EALE,CAAd;;AAOA,UAAI,OAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,EAA0B,OAA1B,EAAmC,iBAAS;AAC9C,YAAI,KAAJ;AACD,OAFG,CAAJ;AAGD,KAZM,CAAP;AAaD,G;;;;;kBArBkB,Q","file":"Graphite.js","sourcesContent":["import CarbonClient from 'graphite/lib/CarbonClient';\n\nexport default class Graphite extends CarbonClient {\n  constructor(host, port) {\n    super({ dsn: `plaintext://${host}:${port}/` });\n  }\n\n  write(metrics) {\n    this._lazyConnect();\n\n    return new Promise((res, rej) => {\n\n      const lines = Object.keys(metrics).reduce((prevLines, key) => {\n        const value = metrics[key].value;\n        const timestamp = Math.floor((metrics[key].timestamp || Date.now()) / 1000);\n        prevLines.push(`${[ key, value, timestamp ].join(' ')}\\n`);\n        return prevLines;\n      }, []).join('');\n\n      res(this._socket.write(lines, 'UTF-8', error => {\n        rej(error);\n      }));\n    });\n  }\n}\n"]}