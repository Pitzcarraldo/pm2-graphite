{"version":3,"sources":["../src/Metrics.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;;;;;IAEqB,O;AACnB,qBAAc;AAAA;;AACZ,SAAK,OAAL,GAAe,EAAf;AACD;;oBAED,I,iBAAK,E,EAAI,O,EAAS;AAChB,QAAM,OAAO,oBAAQ,OAAR,CAAb;AACA,QAAM,YAAY,KAAK,GAAL,EAAlB;AACA,SAAK,OAAL,CAAa,IAAb,CAAkB,oBAAY,IAAZ,EAAkB,MAAlB,CAAyB,UAAC,WAAD,EAAc,UAAd,EAA6B;AACtE,kBAAY,WAAW,OAAX,CAAmB,KAAnB,EAA0B,EAA1B,CAAZ,IAA6C;AAC3C,eAAO,yBAAe,KAAK,UAAL,CAAf,CADoC;AAE3C;AAF2C,OAA7C;AAIA,aAAO,WAAP;AACD,KANiB,EAMf,EANe,CAAlB;AAOA,WAAO,IAAP;AACD,G;;oBAED,O,sBAAU;AACR,WAAO,KAAK,OAAL,CAAa,MAAb,CAAoB,UAAC,IAAD,EAAO,IAAP;AAAA,wCAAsB,IAAtB,EAA+B,IAA/B;AAAA,KAApB,EAA4D,EAA5D,CAAP;AACD,G;;oBAED,K,oBAAQ;AACN,SAAK,OAAL,GAAe,EAAf;AACA,WAAO,KAAK,OAAZ;AACD,G;;;;;kBAzBkB,O","file":"Metrics.js","sourcesContent":["import flatten from 'flat';\n\nexport default class Metrics {\n  constructor() {\n    this.metrics = [];\n  }\n\n  push(id, metrics) {\n    const flat = flatten(metrics);\n    const timestamp = Date.now();\n    this.metrics.push(Object.keys(flat).reduce((prevMetrics, metricsKey) => {\n      prevMetrics[metricsKey.replace('$id', id)] = {\n        value: JSON.stringify(flat[metricsKey]),\n        timestamp\n      };\n      return prevMetrics;\n    }, {}));\n    return this;\n  }\n\n  flatten() {\n    return this.metrics.reduce((prev, curr) => ({ ...prev, ...curr }), {});\n  }\n\n  empty() {\n    this.metrics = [];\n    return this.metrics;\n  }\n}\n"]}